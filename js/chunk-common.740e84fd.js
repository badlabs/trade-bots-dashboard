"use strict";(self["webpackChunktrade_bots_dashboard"]=self["webpackChunktrade_bots_dashboard"]||[]).push([[64],{3657:(t,e,r)=>{r.d(e,{I:()=>u,y:()=>c});var n=r(9835),o=r(3260),i=r(7363),s=r(1623),a=r(1291);const c=(0,n.aZ)({computed:Object.assign(Object.assign({},(0,i.rn)(s.V,["robots"])),{robot(){const t=this.robots.find((t=>t.name===this.$route.params.robot));return t||o.n.notFound()}})}),u=(0,n.aZ)({computed:Object.assign(Object.assign({},(0,i.rn)(a.R,["algorithms","algorithmNotFound"])),{algorithm(){const t=this.algorithms.find((t=>t.algorithm.name===this.$route.params.algorithm));return t?t.algorithm:this.algorithmNotFound}})})},3260:(t,e,r)=>{r.d(e,{n:()=>n});class n{constructor({name:t,host:e,port:r,token:n}){this.name=t,this.host=e,this.port=r,this.token=n}static notFound(){return new n({name:"Not Found",host:"",port:0,token:""})}get url(){return`http://${this.host}:${this.port}`}get authHeader(){return{Authorization:`Bearer ${this.token}`}}}},1291:(t,e,r)=>{r.d(e,{R:()=>a});var n=r(7363),o=r(9981),i=r.n(o),s=function(t,e,r,n){function o(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(s,a)}c((n=n.apply(t,e||[])).next())}))};const a=(0,n.Q_)("algorithmsStore",{state:()=>({algorithms:[]}),getters:{algorithmNotFound(){return{name:"Not Found",input_types:JSON.stringify({}),description:""}}},actions:{addAlgorithm(t,e){var r;this.algorithms.some((t=>t.algorithm.name===e.name))?null===(r=this.algorithms.find((t=>t.algorithm.name===e.name)))||void 0===r||r.robots.push(t):this.algorithms.push({algorithm:e,robots:[t]})},getAlgorithms(t){return s(this,void 0,void 0,(function*(){const{data:e}=yield i().get(`${t.url}/api/algos`,{headers:t.authHeader});for(let r of e)this.addAlgorithm(t,r);return e}))},getAlgorithmRuns(t,e){return s(this,void 0,void 0,(function*(){const{data:r}=yield i().get(`${t.url}/api/algos/${e}/runs`,{headers:t.authHeader});return r}))},runAlgorithm(t,e,r){return s(this,void 0,void 0,(function*(){const{data:n}=yield i().post(`${t.url}/api/algos/${e}`,r,{headers:t.authHeader});return n}))},stopAlgorithm(t,e,r){return s(this,void 0,void 0,(function*(){const{data:n}=yield i().post(`${t.url}/api/algos/${e}/stop/${r}`,{},{headers:t.authHeader});return n}))},continueAlgorithm(t,e,r){return s(this,void 0,void 0,(function*(){const{data:n}=yield i().post(`${t.url}/api/algos/${e}/continue/${r}`,{},{headers:t.authHeader});return n}))},getAlgorithmInputsTypes(t){return JSON.parse(t.input_types)}}})},3043:(t,e,r)=>{r.d(e,{a:()=>c});var n=r(7363),o=r(1623),i=r(9981),s=r.n(i),a=function(t,e,r,n){function o(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(s,a)}c((n=n.apply(t,e||[])).next())}))};const c=(0,n.Q_)("portfolioActions",{state:()=>({}),getters:{},actions:{getPortfolio(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().get(`${t.url}/api/state/portfolio`,{headers:t.authHeader});return e}))},getCurrenciesBalance(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().get(`${t.url}/api/state/currencies/balance`,{headers:t.authHeader});return e}))},updatePortfolio(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().post(`${t.url}/api/state/portfolio`,{},{headers:t.authHeader});return e}))},getAverageBuyPrice(t,e){return a(this,void 0,void 0,(function*(){const{data:r}=yield s().get(`${t.url}/api/state/portfolio/${e}/average-buy-price`,{headers:t.authHeader});return r}))},getUnitedPortfolio(){return a(this,void 0,void 0,(function*(){const t=(0,o.V)(),e=t.robots,r=e.map((t=>a(this,void 0,void 0,(function*(){return yield this.getPortfolio(t)})))),n=yield Promise.all(r),i=n.reduce(((t,e)=>(e.forEach((e=>{const r=t.find((t=>t.security_ticker==e.security_ticker));r?r.amount+=e.amount:t.push(e)})),t)),[]);return i}))},getUnitedBalance(){return a(this,void 0,void 0,(function*(){const t=(0,o.V)(),e=t.robots,r=e.map((t=>a(this,void 0,void 0,(function*(){return yield this.getCurrenciesBalance(t)})))),n=yield Promise.all(r),i=n.reduce(((t,e)=>(e.forEach((e=>{const r=t.find((t=>t.currency_ticker==e.currency_ticker));r?r.balance+=e.balance:t.push(e)})),t)),[]);return i}))}}})},1354:(t,e,r)=>{r.d(e,{R:()=>c});var n=r(7363),o=r(7898),i=r(9981),s=r.n(i),a=function(t,e,r,n){function o(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(s,a)}c((n=n.apply(t,e||[])).next())}))};const c=(0,n.Q_)("robotActions",{state:()=>({}),getters:{},actions:{getSecurities(t){return a(this,void 0,void 0,(function*(){const e=(0,o.$)(),{data:r}=yield s().get(`${t.url}/api/state/securities`,{headers:t.authHeader});return e.updateSecurities(r),r}))},updateSecurities(t){return a(this,void 0,void 0,(function*(){const e=(0,o.$)(),{data:r}=yield s().post(`${t.url}/api/state/securities`,{},{headers:t.authHeader});return e.updateSecurities(r),r}))},getCurrencies(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().get(`${t.url}/api/state/currencies`,{headers:t.authHeader});return e}))},updateCurrencies(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().post(`${t.url}/api/state/currencies`,{},{headers:t.authHeader});return e}))}}})},1623:(t,e,r)=>{r.d(e,{V:()=>l});var n=r(7363),o=r(3260),i=r(9981),s=r.n(i),a=r(1354),c=r(3043),u=function(t,e,r,n){function o(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(s,a)}c((n=n.apply(t,e||[])).next())}))};const l=(0,n.Q_)("robots",{state:()=>({robots:[]}),getters:{},actions:{checkRobotAuth(t){return u(this,void 0,void 0,(function*(){try{const e=new o.n(t),{data:r}=yield s().get(`${e.url}/api/auth/check`,{headers:e.authHeader});return r.auth}catch(e){return!1}}))},addRobot(t){return u(this,void 0,void 0,(function*(){const e=(0,a.R)(),r=(0,c.a)();if(!this.checkExistingRobot(t)){const n=new o.n(t);yield e.updateSecurities(n),yield r.updatePortfolio(n),this.robots.push(n)}}))},checkExistingRobot(t){const e=new o.n(t);return this.robots.some((t=>t.url===e.url))}}})},7898:(t,e,r)=>{r.d(e,{$:()=>o});var n=r(7363);const o=(0,n.Q_)("securities",{state:()=>({securities:[]}),getters:{},actions:{updateSecurities(t){t.forEach((t=>{const e=this.securities.find((e=>e.ticker===t.ticker));e?e.price=t.price:this.securities.push(t)}))},getSecurity(t){return this.securities.find((e=>e.ticker===t))}}})},6194:(t,e,r)=>{r.d(e,{Z:()=>p});var n=r(9835),o=r(6970);function i(t,e,r,i,s,a){const c=(0,n.up)("q-avatar");return(0,n.wg)(),(0,n.j4)(c,{size:"1.5em",color:t.color,class:"text-white"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.firstLetter),1)])),_:1},8,["color"])}const s=r(5168),a=(0,n.aZ)({name:"RobotAvatar",props:{name:{type:String,required:!0}},data(){return{colors:["red","blue","orange","green","teal","purple","deep-purple","indigo","brown"],rand:s(this.name)}},computed:{color(){return this.colors[this.rand(this.colors.length)]},firstLetter(){return this.name.substring(0,1).toUpperCase()}}});var c=r(1639),u=r(1357),l=r(9984),d=r.n(l);const h=(0,c.Z)(a,[["render",i]]),p=h;d()(a,"components",{QAvatar:u.Z})},4022:(t,e,r)=>{r.d(e,{Z:()=>h});var n=r(9835),o=r(6970);const i={style:{"overflow-y":"auto"}};function s(t,e,r,s,a,c){return(0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("pre",{class:"bg-black text-white q-pa-md",style:(0,o.j5)({whiteSpace:t.singleLine?"pre-wrap":void 0})},(0,o.zw)(t.singleLine?t.lastLine:t.logs),5)])}var a=r(3819),c=r(3260);const u=(0,n.aZ)({name:"RobotLogs",props:{robot:{type:c.n,required:!0},singleLine:{type:Boolean,required:!1}},data(){return{connection:null,logs:""}},computed:{lastLine(){return this.logs.split("\n").slice(-2)[0]}},mounted(){const t=`${this.robot.url}`;this.connection=(0,a.io)(t),this.connection.on("log",(t=>{console.log(t),this.logs+=t+"\n"}))},beforeUnmount(){var t;null===(t=this.connection)||void 0===t||t.close()}});var l=r(1639);const d=(0,l.Z)(u,[["render",s]]),h=d},4268:(t,e,r)=>{r.d(e,{Z:()=>W});var n=r(9835),o=r(6970);const i={class:"q-px-md q-my-lg q-mx-auto",style:{"max-width":"800px",background:"lightgray","border-radius":"5px"}},s=(0,n.Uk)("Portfolio");function a(t,e,r,a,c,u){const l=(0,n.up)("q-card-section"),d=(0,n.up)("CurrencySign"),h=(0,n.up)("PortfolioItem"),p=(0,n.up)("q-list"),f=(0,n.up)("q-spinner-ball"),g=(0,n.up)("q-inner-loading");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n.Wm)(l,{class:"text-h4"},{default:(0,n.w5)((()=>[(0,n.WI)(t.$slots,"default",{},(()=>[s]))])),_:3}),t.balance?((0,n.wg)(),(0,n.j4)(l,{key:0,class:"bg-white q-mx-md rounded-borders"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.balance,(t=>((0,n.wg)(),(0,n.iD)("span",{key:t.currency_ticker,class:"q-mr-md"},[(0,n.Uk)((0,o.zw)(t.balance.toLocaleString("de-DE")),1),(0,n.Wm)(d,{ticker:t.currency_ticker,class:"text-bold"},null,8,["ticker"])])))),128))])),_:1})):(0,n.kq)("",!0),(0,n.Wm)(l,{class:"q-pa-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{separator:"",style:{"max-height":"300px","overflow-y":"auto"},class:"bg-white rounded-borders"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.portfolio,((e,r)=>((0,n.wg)(),(0,n.j4)(h,{key:r,"portfolio-position":e,robot:t.robot},null,8,["portfolio-position","robot"])))),128))])),_:1})])),_:1}),(0,n.Wm)(g,{showing:t.loading},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{size:"50px",color:"primary"})])),_:1},8,["showing"])])}var c=r(3043),u=r(7363);function l(t,e,r,i,s,a){const c=(0,n.up)("q-item-label"),u=(0,n.up)("q-item-section"),l=(0,n.up)("CurrencySign"),d=(0,n.up)("q-spinner-facebook"),h=(0,n.up)("q-inner-loading"),p=(0,n.up)("q-item");return(0,n.wg)(),(0,n.j4)(p,null,{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{style:{"font-size":"18px","font-weight":"bold"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.security.name),1)])),_:1}),(0,n.Wm)(c,{caption:"",style:{"font-size":"14px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.portfolioPosition.security_ticker)+" x"+(0,o.zw)(t.portfolioPosition.amount),1)])),_:1})])),_:1}),(0,n.Wm)(u,{side:"",top:""},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{caption:"",style:{"font-size":"16px","font-weight":"bold"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.security.price)+" ",1),(0,n.Wm)(l,{ticker:t.security.currency_ticker},null,8,["ticker"])])),_:1}),t.robot?((0,n.wg)(),(0,n.j4)(c,{key:0,caption:"",class:(0,o.C_)("text-"+(t.growth?"green":"red")),style:{"font-size":"14px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t.growth?"↑":"↓")+(0,o.zw)(t.buyPrice.price)+" ",1),(0,n.Wm)(l,{ticker:t.security.currency_ticker},null,8,["ticker"]),(0,n.Uk)(" ("+(0,o.zw)(t.diffRelative)+" %) ",1)])),_:1},8,["class"])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(h,{showing:t.loading},{default:(0,n.w5)((()=>[(0,n.Wm)(d)])),_:1},8,["showing"])])),_:1})}var d=r(3260),h=r(7898);function p(t,e,r,i,s,a){return(0,n.wg)(),(0,n.iD)("span",null,(0,o.zw)(t.sign),1)}const f=(0,n.aZ)({name:"CurrencySign",props:{ticker:{type:String,required:!0}},computed:{sign(){switch(this.ticker){case"USD":return"$";case"RUB":return"₽";case"EUR":return"€";default:return"M"}}}});var g=r(1639);const m=(0,g.Z)(f,[["render",p]]),y=m;var v=function(t,e,r,n){function o(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(s,a)}c((n=n.apply(t,e||[])).next())}))};const b=(0,n.aZ)({name:"PortfolioItem",components:{CurrencySign:y},props:{portfolioPosition:{type:Object,required:!0},robot:{type:d.n,required:!1}},data(){return{buyPrice:{ticker:"",price:0},loading:!0}},methods:Object.assign(Object.assign({},(0,u.nv)(c.a,["getAverageBuyPrice"])),(0,u.nv)(h.$,["getSecurity"])),computed:Object.assign(Object.assign({},(0,u.rn)(h.$,["securities"])),{security(){return this.getSecurity(this.portfolioPosition.security_ticker)},growth(){var t;return((null===(t=this.security)||void 0===t?void 0:t.price)||0)>this.buyPrice.price},diffAbsolute(){var t;let e=Math.abs(((null===(t=this.security)||void 0===t?void 0:t.price)||0)-this.buyPrice.price);return Math.round(100*e)/100},diffRelative(){let t=this.diffAbsolute/this.buyPrice.price*100;return Math.round(100*t)/100}}),created(){return v(this,void 0,void 0,(function*(){this.loading=!0,this.robot&&(this.buyPrice=yield this.getAverageBuyPrice(this.robot,this.portfolioPosition.security_ticker)),this.loading=!1}))}});var w=r(490),k=r(1233),_=r(3115),P=r(854),$=r(7234),x=r(9984),q=r.n(x);const S=(0,g.Z)(b,[["render",l]]),Z=S;q()(b,"components",{QItem:w.Z,QItemSection:k.Z,QItemLabel:_.Z,QInnerLoading:P.Z,QSpinnerFacebook:$.Z});var A=function(t,e,r,n){function o(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,i){function s(t){try{c(n.next(t))}catch(e){i(e)}}function a(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(s,a)}c((n=n.apply(t,e||[])).next())}))};const U=(0,n.aZ)({name:"PortfolioView",components:{CurrencySign:y,PortfolioItem:Z},props:{robot:{type:Object,required:!1}},data(){return{portfolio:[],balance:[],loading:!1}},methods:Object.assign(Object.assign({},(0,u.nv)(c.a,["getAverageBuyPrice","getUnitedPortfolio","getUnitedBalance","getPortfolio","getCurrenciesBalance"])),{fetch(){return A(this,void 0,void 0,(function*(){this.loading=!0;try{this.robot?(this.portfolio=yield this.getPortfolio(this.robot),this.balance=yield this.getCurrenciesBalance(this.robot)):(this.portfolio=yield this.getUnitedPortfolio(),this.balance=yield this.getUnitedBalance())}catch(t){this.portfolio=[],this.balance=[]}this.loading=!1}))}}),watch:{robot(){this.fetch()}},mounted(){this.fetch()}});var j=r(3190),z=r(3246),H=r(5304);const C=(0,g.Z)(U,[["render",a]]),W=C;q()(U,"components",{QCardSection:j.Z,QList:z.Z,QInnerLoading:P.Z,QSpinnerBall:H.Z})}}]);