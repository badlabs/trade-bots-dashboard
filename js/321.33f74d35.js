"use strict";(self["webpackChunktrade_bots_dashboard"]=self["webpackChunktrade_bots_dashboard"]||[]).push([[321],{3260:(t,e,o)=>{o.d(e,{n:()=>n});class n{constructor({name:t,host:e,port:o,token:n}){this.name=t,this.host=e,this.port=o,this.token=n}get url(){return`http://${this.host}:${this.port}`}get authHeader(){return{Authorization:`Bearer ${this.token}`}}}},410:(t,e,o)=>{o.d(e,{I:()=>u});var n=o(7363),i=o(7898),r=o(1623),a=o(1354),s=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{u(n.next(t))}catch(e){r(e)}}function s(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?o(t.value):i(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};const u=(0,n.Q_)("robotStatisticsActions",{state:()=>({}),getters:{},actions:{getPositionStatistics(t){(0,i.$)();return{buyPrice:0,price:0,growth:!0,diffAbs:0,diffPer:0}},getPortfolioStatistics(t){(0,i.$)();return{buyPriceAll:0,priceAll:0,growth:!0,diffAbs:0,diffPer:0}},getUnitePortfolioStatistics(){return s(this,void 0,void 0,(function*(){(0,i.$)();const t=(0,r.V)(),e=(0,a.R)(),o=t.robots,n=o.map((t=>s(this,void 0,void 0,(function*(){return yield e.getPortfolio(t)})))),u=yield Promise.all(n),l=u.reduce(((t,e)=>(e.forEach((e=>{const o=t.find((t=>t.security_ticker==e.security_ticker));o?o.amount+=e.amount:t.push(e)})),t)),[]);return{unitedPortfolio:l,unitedPortfolioStatistics:this.getPortfolioStatistics(l)}}))}}})},1354:(t,e,o)=>{o.d(e,{R:()=>u});var n=o(7363),i=o(7898),r=o(9981),a=o.n(r),s=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{u(n.next(t))}catch(e){r(e)}}function s(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?o(t.value):i(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};const u=(0,n.Q_)("robotActions",{state:()=>({}),getters:{},actions:{getSecurities(t){return s(this,void 0,void 0,(function*(){const e=(0,i.$)(),{data:o}=yield a().get(`${t.url}/api/state/securities`,{headers:t.authHeader});return e.updateSecurities(o),o}))},updateSecurities(t){return s(this,void 0,void 0,(function*(){const e=(0,i.$)(),{data:o}=yield a().post(`${t.url}/api/state/securities`,{},{headers:t.authHeader});return e.updateSecurities(o),o}))},getPortfolio(t){return s(this,void 0,void 0,(function*(){const{data:e}=yield a().get(`${t.url}/api/state/portfolio`,{headers:t.authHeader});return e}))},updatePortfolio(t){return s(this,void 0,void 0,(function*(){const{data:e}=yield a().post(`${t.url}/api/state/portfolio`,{},{headers:t.authHeader});return e}))},getCurrencies(t){return s(this,void 0,void 0,(function*(){const{data:e}=yield a().get(`${t.url}/api/state/currencies`,{headers:t.authHeader});return e}))},updateCurrencies(t){return s(this,void 0,void 0,(function*(){const{data:e}=yield a().post(`${t.url}/api/state/currencies`,{},{headers:t.authHeader});return e}))}}})},1623:(t,e,o)=>{o.d(e,{V:()=>l});var n=o(7363),i=o(3260),r=o(9981),a=o.n(r),s=o(1354),u=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{u(n.next(t))}catch(e){r(e)}}function s(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?o(t.value):i(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};const l=(0,n.Q_)("robots",{state:()=>({robots:[]}),getters:{},actions:{checkRobotAuth(t){return u(this,void 0,void 0,(function*(){try{const e=new i.n(t),{data:o}=yield a().get(`${e.url}/api/auth/check`,{headers:e.authHeader});return o.auth}catch(e){return!1}}))},addRobot(t){return u(this,void 0,void 0,(function*(){const e=(0,s.R)();if(!this.checkExistingRobot(t)){const o=new i.n(t);yield e.updateSecurities(o),yield e.updatePortfolio(o),this.robots.push(o)}}))},checkExistingRobot(t){const e=new i.n(t);return this.robots.some((t=>t.url===e.url))}}})},7898:(t,e,o)=>{o.d(e,{$:()=>i});var n=o(7363);const i=(0,n.Q_)("securities",{state:()=>({securities:[]}),getters:{},actions:{updateSecurities(t){t.forEach((t=>{const e=this.securities.find((e=>e.ticker===t.ticker));e?e.price=t.price:this.securities.push(t)}))},getSecurity(t){return this.securities.find((e=>e.ticker===t))}}})},2913:(t,e,o)=>{o.d(e,{Z:()=>_});var n=o(9835),i=o(6970);const r={class:"q-px-md q-my-lg q-mx-auto",style:{"max-width":"800px",background:"lightgray","border-radius":"5px"}},a={class:"q-pa-md"},s={class:"q-pt-md",style:{"font-size":"16px","font-weight":"bold"}},u={class:"q-pa-md"};function l(t,e,o,l,c,d){const p=(0,n.up)("q-item-label"),h=(0,n.up)("q-item-section"),m=(0,n.up)("q-item"),f=(0,n.up)("q-list");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",a,[(0,n._)("div",s," Total Currencies: $"+(0,i.zw)(t.statistics.priceAll),1),(0,n._)("div",{style:{"font-size":"14px"},class:(0,i.C_)("text-"+(t.statistics.growth?"green":"red"))},(0,i.zw)(t.statistics.growth?"↑":"↓")+(0,i.zw)(t.statistics.diffAbs)+" $ ("+(0,i.zw)(t.statistics.diffPer)+" %) ",3)]),(0,n._)("div",u,[(0,n.Wm)(f,{separator:"",style:{"max-height":"300px","overflow-y":"auto"},class:"bg-white"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.portfolio,((e,o)=>((0,n.wg)(),(0,n.j4)(m,{key:o},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(p,{style:{"font-size":"18px","font-weight":"bold"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(e.security_ticker),1)])),_:2},1024),(0,n.Wm)(p,{caption:"",style:{"font-size":"14px"}},{default:(0,n.w5)((()=>[(0,n.Uk)("x"+(0,i.zw)(e.amount),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(h,{side:"",top:""},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{caption:"",style:{"font-size":"16px","font-weight":"bold"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.getPositionStatistics(e).price)+" $ ",1)])),_:2},1024),(0,n.Wm)(p,{caption:"",class:(0,i.C_)("text-"+(t.getPositionStatistics(e).growth?"green":"red")),style:{"font-size":"14px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.getPositionStatistics(e).growth?"↑":"↓")+(0,i.zw)(t.getPositionStatistics(e).diffAbs)+" $ ("+(0,i.zw)(t.getPositionStatistics(e).diffPer)+" %) ",1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])}var c=o(410),d=o(7363);const p=(0,n.aZ)({name:"PortfolioStatistics",props:{portfolio:{type:Array,required:!0}},computed:{statistics(){return this.getPortfolioStatistics(this.portfolio)}},methods:Object.assign({},(0,d.nv)(c.I,["getPortfolioStatistics","getPositionStatistics"]))});var h=o(1639),m=o(3246),f=o(490),g=o(1233),w=o(3115),b=o(9984),y=o.n(b);const v=(0,h.Z)(p,[["render",l]]),_=v;y()(p,"components",{QList:m.Z,QItem:f.Z,QItemSection:g.Z,QItemLabel:w.Z})},4321:(t,e,o)=>{o.r(e),o.d(e,{default:()=>lt});var n=o(9835),i=o(6970);const r={class:"q-pa-md"},a={class:"q-gutter-sm"},s={class:"row justify-between"};function u(t,e,o,u,l,c){const d=(0,n.up)("q-btn"),p=(0,n.up)("RobotLogsModal"),h=(0,n.up)("PortfolioStatistics"),m=(0,n.up)("AlgosList");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",a,[(0,n.Wm)(d,{color:"primary",to:"/robots",label:"< Robots"})]),(0,n._)("div",s,[(0,n._)("h4",null,"Robot "+(0,i.zw)(t.robot.name),1),(0,n._)("div",null,[(0,n.Wm)(p,{robot:t.robot},null,8,["robot"])])]),(0,n.Wm)(h,{portfolio:t.portfolio},null,8,["portfolio"]),(0,n.Wm)(m,{algorithms:t.algorithms,robot:t.robot},null,8,["algorithms","robot"])])}var l=o(1623),c=o(1354),d=o(7363),p=o(3260),h=o(2913);const m={class:"bg-black text-white q-pa-md",style:{"max-width":"600px","max-height":"400px",overflow:"auto"}},f=(0,n.Uk)("Close"),g=(0,n.Uk)("Logs");function w(t,e,o,r,a,s){const u=(0,n.up)("q-card-section"),l=(0,n.up)("q-btn"),c=(0,n.up)("q-card-actions"),d=(0,n.up)("q-card"),p=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(p,{modelValue:t.show,"onUpdate:modelValue":e[1]||(e[1]=e=>t.show=e),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{style:{"min-width":"400px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Logs "+(0,i.zw)(t.robot.name),1)])),_:1}),(0,n._)("code",null,[(0,n._)("pre",m,(0,i.zw)(t.logs),1)]),(0,n.Wm)(c,{align:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{color:"red",onClick:e[0]||(e[0]=e=>t.show=!t.show)},{default:(0,n.w5)((()=>[f])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(l,{onClick:e[2]||(e[2]=e=>t.show=!t.show),color:"primary"},{default:(0,n.w5)((()=>[g])),_:1})],64)}var b=o(3819);const y=(0,n.aZ)({name:"RobotLogsModal",props:{robot:{type:p.n,required:!0}},data(){return{show:!1,connection:null,logs:""}},created(){const t=`${this.robot.url}`;this.connection=(0,b.io)(t),this.connection.on("log",(t=>{console.log(t),this.logs+=t+"\n"}))},beforeDestroy(){var t;null===(t=this.connection)||void 0===t||t.close()}});var v=o(1639),_=o(7743),k=o(4458),q=o(3190),x=o(1821),V=o(4455),Z=o(9984),W=o.n(Z);const A=(0,v.Z)(y,[["render",w]]),S=A;W()(y,"components",{QDialog:_.Z,QCard:k.Z,QCardSection:q.Z,QCardActions:x.Z,QBtn:V.Z});const P=(0,n.Uk)(" Algorithms ");function Q(t,e,o,r,a,s){const u=(0,n.up)("q-card-section"),l=(0,n.up)("q-item-section"),c=(0,n.up)("q-chip"),d=(0,n.up)("q-item-label"),p=(0,n.up)("q-item"),h=(0,n.up)("q-list"),m=(0,n.up)("RunAlgoModal"),f=(0,n.up)("q-card-actions"),g=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(g,{class:"q-pa-md q-my-lg q-mx-auto",style:{"max-width":"800px",background:"lightblue","border-radius":"5px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{class:"text-h3"},{default:(0,n.w5)((()=>[P])),_:1}),(0,n.Wm)(h,{style:{"max-height":"300px","overflow-y":"auto"},separator:""},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.algorithms,((e,o)=>((0,n.wg)(),(0,n.j4)(p,{key:o,dense:""},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{class:"q-pa-sm q-my-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"my-card",style:{"max-height":"300px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{class:"text-h5"},{default:(0,n.w5)((()=>[(0,n.Uk)("Algorithm "+(0,i.zw)(e.name),1)])),_:2},1024),(0,n.Wm)(h,{separator:"",class:"bg-white"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.inputsForAlgorithm(e),(t=>((0,n.wg)(),(0,n.j4)(p,{key:t.name},{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.name),1)])),_:2},1024),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n._)("code",null,(0,i.zw)(t.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024),(0,n.Wm)(f,{align:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{robot:t.robot,algorithm:e},null,8,["robot","algorithm"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})}var C=o(1957);const $=(0,n.Uk)(" Start "),z=(0,n.Uk)("Cancel"),I=(0,n.Uk)("Run");function U(t,e,o,i,r,a){const s=(0,n.up)("q-input"),u=(0,n.up)("OrderOptionsInput"),l=(0,n.up)("q-card-section"),c=(0,n.up)("q-btn"),d=(0,n.up)("q-card-actions"),p=(0,n.up)("q-form"),h=(0,n.up)("q-card"),m=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(m,{modelValue:t.show,"onUpdate:modelValue":e[1]||(e[1]=e=>t.show=e),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{style:{"min-width":"400px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{onSubmit:(0,C.iM)(t.startAlgo,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.fields,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t.name},["number"===t.type?((0,n.wg)(),(0,n.j4)(s,{key:0,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,type:"number",label:t.name},null,8,["modelValue","onUpdate:modelValue","label"])):"OrderDetails"===t.type?((0,n.wg)(),(0,n.j4)(u,{key:1,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,label:t.name},null,8,["modelValue","onUpdate:modelValue","label"])):(0,n.kq)("",!0)])))),128))])),_:1}),(0,n.Wm)(d,{align:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{color:"primary",type:"submit",loading:t.loading},{default:(0,n.w5)((()=>[$])),_:1},8,["loading"]),(0,n.Wm)(c,{color:"red",onClick:e[0]||(e[0]=e=>t.show=!t.show)},{default:(0,n.w5)((()=>[z])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(c,{onClick:e[2]||(e[2]=e=>t.show=!t.show),color:"primary"},{default:(0,n.w5)((()=>[I])),_:1})],64)}function O(t,e,o,r,a,s){const u=(0,n.up)("q-input"),l=(0,n.up)("q-select"),c=(0,n.up)("q-card-section"),d=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"row justify-between"},{default:(0,n.w5)((()=>[(0,n._)("div",null,(0,i.zw)(t.label||"OrderDetails"),1),(0,n._)("div",null,[(0,n.Wm)(u,{modelValue:t.currentValue.ticker,"onUpdate:modelValue":e[0]||(e[0]=e=>t.currentValue.ticker=e),label:"Ticker",onInput:t.input},null,8,["modelValue","onInput"]),(0,n.Wm)(l,{modelValue:t.currentValue.operation,"onUpdate:modelValue":e[1]||(e[1]=e=>t.currentValue.operation=e),options:t.operationTypes,label:"Operation",onInput:t.input},null,8,["modelValue","options","onInput"]),(0,n.Wm)(u,{modelValue:t.currentValue.price,"onUpdate:modelValue":e[2]||(e[2]=e=>t.currentValue.price=e),type:"number",label:"Price",onInput:t.input},null,8,["modelValue","onInput"]),(0,n.Wm)(u,{modelValue:t.currentValue.lots,"onUpdate:modelValue":e[3]||(e[3]=e=>t.currentValue.lots=e),type:"number",label:"Lots",onInput:t.input},null,8,["modelValue","onInput"])])])),_:1})])),_:1})}const R=(0,n.aZ)({name:"OrderOptionsInput",props:{label:String,modelValue:{type:Object,required:!0}},data(){return{currentValue:this.modelValue,operationTypes:["buy","sell","buy_or_cancel","sell_or_cancel"]}},methods:{input(){this.$emit("update:modelValue",this.currentValue)},onValueChange(t){this.currentValue=t,this.input()}},watch:{value(t){this.onValueChange(t)}}});var j=o(6611),D=o(8542);const H=(0,v.Z)(R,[["render",O]]),L=H;W()(R,"components",{QCard:k.Z,QCardSection:q.Z,QInput:j.Z,QSelect:D.Z});var M=o(9981),T=o.n(M),Y=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{u(n.next(t))}catch(e){r(e)}}function s(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?o(t.value):i(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};const E=(0,d.Q_)("algorithmsActions",{state:()=>({}),getters:{},actions:{getAlgorithms(t){return Y(this,void 0,void 0,(function*(){const{data:e}=yield T().get(`${t.url}/api/algos`,{headers:t.authHeader});return e}))},runAlgorithm(t,e,o){return Y(this,void 0,void 0,(function*(){const{data:n}=yield T().post(`${t.url}/api/algos/${e}`,o,{headers:t.authHeader});return n}))},getAlgorithmInputsTypes(t){return JSON.parse(t.input_types)}}});var B=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{u(n.next(t))}catch(e){r(e)}}function s(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?o(t.value):i(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};const K=(0,n.aZ)({name:"RunAlgoModal",props:{algorithm:{type:Object,required:!0},robot:{type:p.n,required:!0}},components:{OrderOptionsInput:L},data(){return{show:!1,loading:!1,fields:[]}},methods:Object.assign(Object.assign({},(0,d.nv)(E,["runAlgorithm","getAlgorithmInputsTypes"])),{startAlgo(){return B(this,void 0,void 0,(function*(){this.loading=!0;const t={};this.fields.forEach((e=>{t[e.name]=e.value})),yield this.runAlgorithm(this.robot,this.algorithm.name,t),this.loading=!1,this.show=!1}))}}),created(){const t=this.getAlgorithmInputsTypes(this.algorithm);this.fields=Object.keys(t).map((e=>{let o=t[e],n=0;switch(o){case"number":n=0;break;case"OrderDetails":n={lots:0,operation:"limit_buy",price:0,ticker:""}}return{name:e,type:o,value:n}}))}});var F=o(8326);const J=(0,v.Z)(K,[["render",U]]),N=J;W()(K,"components",{QDialog:_.Z,QCard:k.Z,QForm:F.Z,QCardSection:q.Z,QInput:j.Z,QCardActions:x.Z,QBtn:V.Z});const G=(0,n.aZ)({name:"AlgosList",props:{algorithms:{type:Array,required:!0},robot:{type:p.n,required:!0}},methods:{inputsForAlgorithm(t){return JSON.parse(t.input_types)}},components:{RunAlgoModal:N}});var X=o(3246),tt=o(490),et=o(1233),ot=o(3115),nt=o(7691);const it=(0,v.Z)(G,[["render",Q]]),rt=it;W()(G,"components",{QCard:k.Z,QCardSection:q.Z,QList:X.Z,QItem:tt.Z,QItemSection:et.Z,QItemLabel:ot.Z,QChip:nt.Z,QCardActions:x.Z});var at=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{u(n.next(t))}catch(e){r(e)}}function s(t){try{u(n["throw"](t))}catch(e){r(e)}}function u(t){t.done?o(t.value):i(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())}))};const st=(0,n.aZ)({name:"RobotScreen",components:{PortfolioStatistics:h.Z,AlgosList:rt,RobotLogsModal:S},data(){return{portfolio:[],algorithms:[]}},computed:Object.assign(Object.assign({},(0,d.rn)(l.V,["robots"])),{robot(){const t=this.robots.find((t=>t.name===this.$route.params.robot));return t||(this.$router.push("/"),new p.n({name:"",host:"",port:0,token:""}))}}),methods:Object.assign(Object.assign(Object.assign({},(0,d.nv)(c.R,["getPortfolio"])),(0,d.nv)(E,["getAlgorithms"])),{updateRobotData(){return at(this,void 0,void 0,(function*(){this.portfolio=yield this.getPortfolio(this.robot),this.algorithms=yield this.getAlgorithms(this.robot)}))}}),watch:{robot(){this.updateRobotData()}},created(){this.updateRobotData()}}),ut=(0,v.Z)(st,[["render",u]]),lt=ut;W()(st,"components",{QBtn:V.Z})}}]);