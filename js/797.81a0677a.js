"use strict";(self["webpackChunktrade_bots_dashboard"]=self["webpackChunktrade_bots_dashboard"]||[]).push([[797],{3260:(t,o,e)=>{e.d(o,{n:()=>r});class r{constructor({name:t,host:o,restPort:e,wsPort:r,token:n}){this.name=t,this._host=o,this._restPort=e,this._wsPort=r,this._token=n}get restUrl(){return`http://${this._host}:${this._restPort}`}get wsUrl(){return`ws://${this._host}:${this._wsPort}`}get authHeader(){return{Authorization:`Bearer ${this._token}`}}}},410:(t,o,e)=>{e.d(o,{I:()=>a});var r=e(7363),n=e(7898),i=e(1623),s=e(1354),c=function(t,o,e,r){function n(t){return t instanceof e?t:new e((function(o){o(t)}))}return new(e||(e=Promise))((function(e,i){function s(t){try{a(r.next(t))}catch(o){i(o)}}function c(t){try{a(r["throw"](t))}catch(o){i(o)}}function a(t){t.done?e(t.value):n(t.value).then(s,c)}a((r=r.apply(t,o||[])).next())}))};const a=(0,r.Q_)("robotStatisticsActions",{state:()=>({}),getters:{},actions:{getPositionStatistics(t){const o=(0,n.$)(),e=o.getSecurity(t.security_ticker);if(!e)return;const r=t.amount*(t.buy_price||e.price),i=t.amount*e.price,s=Math.abs(r-i),c=s/r*100;return{buyPrice:r,price:i,growth:i>r,diffAbs:s,diffPer:c}},getPortfolioStatistics(t){const o=(0,n.$)(),e=t.reduce(((t,e)=>{const r=o.getSecurity(e.security_ticker);return r?t+(e.buy_price||r.price)*(e.amount||0):t}),0),r=o.securities.reduce(((o,e)=>{const r=t.find((t=>t.security_ticker===e.ticker));return r?o+(e.price*r.amount||0):o}),0),i=Math.abs(e-r),s=i/e*100;return{buyPriceAll:e,priceAll:r,growth:r>e,diffAbs:i,diffPer:s}},getUnitePortfolioStatistics(){return c(this,void 0,void 0,(function*(){(0,n.$)();const t=(0,i.V)(),o=(0,s.R)(),e=t.robots,r=e.map((t=>c(this,void 0,void 0,(function*(){return yield o.getPortfolio(t)})))),a=yield Promise.all(r),u=a.reduce(((t,o)=>(o.forEach((o=>{const e=t.find((t=>t.security_ticker==o.security_ticker));e?e.amount+=o.amount:t.push(o)})),t)),[]);return{unitedPortfolio:u,unitedPortfolioStatistics:this.getPortfolioStatistics(u)}}))}}})},1354:(t,o,e)=>{e.d(o,{R:()=>a});var r=e(7363),n=e(7898),i=e(9981),s=e.n(i),c=function(t,o,e,r){function n(t){return t instanceof e?t:new e((function(o){o(t)}))}return new(e||(e=Promise))((function(e,i){function s(t){try{a(r.next(t))}catch(o){i(o)}}function c(t){try{a(r["throw"](t))}catch(o){i(o)}}function a(t){t.done?e(t.value):n(t.value).then(s,c)}a((r=r.apply(t,o||[])).next())}))};const a=(0,r.Q_)("robotActions",{state:()=>({}),getters:{},actions:{getSecurities(t){return c(this,void 0,void 0,(function*(){const o=(0,n.$)(),{data:e}=yield s().get(`${t.restUrl}/api/state/securities`,{headers:t.authHeader});return o.updateSecurities(e),e}))},updateSecurities(t){return c(this,void 0,void 0,(function*(){const o=(0,n.$)(),{data:e}=yield s().post(`${t.restUrl}/api/state/securities`,{},{headers:t.authHeader});return o.updateSecurities(e),e}))},getPortfolio(t){return c(this,void 0,void 0,(function*(){const{data:o}=yield s().get(`${t.restUrl}/api/state/portfolio`,{headers:t.authHeader});return o}))},updatePortfolio(t){return c(this,void 0,void 0,(function*(){const{data:o}=yield s().post(`${t.restUrl}/api/state/portfolio`,{},{headers:t.authHeader});return o}))},getAlgorithms(t){return c(this,void 0,void 0,(function*(){const{data:o}=yield s().get(`${t.restUrl}/api/algos`,{headers:t.authHeader});return o}))}}})},1623:(t,o,e)=>{e.d(o,{V:()=>u});var r=e(7363),n=e(3260),i=e(9981),s=e.n(i),c=e(1354),a=function(t,o,e,r){function n(t){return t instanceof e?t:new e((function(o){o(t)}))}return new(e||(e=Promise))((function(e,i){function s(t){try{a(r.next(t))}catch(o){i(o)}}function c(t){try{a(r["throw"](t))}catch(o){i(o)}}function a(t){t.done?e(t.value):n(t.value).then(s,c)}a((r=r.apply(t,o||[])).next())}))};const u=(0,r.Q_)("robots",{state:()=>({robots:[]}),getters:{},actions:{checkRobotAuth(t){return a(this,void 0,void 0,(function*(){try{const o=new n.n(t),{data:e}=yield s().get(`${o.restUrl}/api/auth/check`,{headers:o.authHeader});return e.auth}catch(o){return!1}}))},addRobot(t){return a(this,void 0,void 0,(function*(){const o=(0,c.R)();if(!this.checkExistingRobot(t)){const e=new n.n(t);yield o.updateSecurities(e),yield o.updatePortfolio(e),this.robots.push(e)}}))},checkExistingRobot(t){const o=new n.n(t);return this.robots.some((t=>t.restUrl===o.restUrl||t.wsUrl===o.wsUrl))}}})},7898:(t,o,e)=>{e.d(o,{$:()=>n});var r=e(7363);const n=(0,r.Q_)("securities",{state:()=>({securities:[]}),getters:{},actions:{updateSecurities(t){t.forEach((t=>{const o=this.securities.find((o=>o.ticker===t.ticker));o?o.price=t.price:this.securities.push(t)}))},getSecurity(t){return this.securities.find((o=>o.ticker===t))}}})},2797:(t,o,e)=>{e.r(o),e.d(o,{default:()=>Y});var r=e(9835);const n={class:"q-pa-md"},i={class:"q-gutter-sm"},s={class:"row justify-between"},c=(0,r._)("h4",null,"List of Robots",-1);function a(t,o,e,a,u,l){const d=(0,r.up)("q-btn"),h=(0,r.up)("ConnectRobotModal"),f=(0,r.up)("RobotTile");return(0,r.wg)(),(0,r.iD)("div",n,[(0,r._)("div",i,[(0,r.Wm)(d,{color:"primary",href:"#/",label:"< Main"})]),(0,r._)("div",s,[c,(0,r._)("div",null,[(0,r.Wm)(h)])]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.robotsStore.robots,((t,o)=>((0,r.wg)(),(0,r.j4)(f,{key:o,robot:t,class:"q-my-sm"},null,8,["robot"])))),128))])}var u=e(1957);const l=(0,r.Uk)("Connect"),d=(0,r.Uk)(" Check "),h=(0,r.Uk)("Cancel");function f(t,o,e,n,i,s){const c=(0,r.up)("q-input"),a=(0,r.up)("q-card-section"),f=(0,r.up)("q-btn"),p=(0,r.up)("q-card-actions"),m=(0,r.up)("q-form"),b=(0,r.up)("q-card"),w=(0,r.up)("q-dialog");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(w,{modelValue:t.show,"onUpdate:modelValue":o[6]||(o[6]=o=>t.show=o),persistent:""},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{style:{"min-width":"400px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{onSubmit:(0,u.iM)(t.checkRobot,["prevent"])},{default:(0,r.w5)((()=>[(0,r.Wm)(a,null,{default:(0,r.w5)((()=>[(0,r.Wm)(c,{modelValue:t.robotOptions.name,"onUpdate:modelValue":o[0]||(o[0]=o=>t.robotOptions.name=o),label:"Name*"},null,8,["modelValue"]),(0,r.Wm)(c,{modelValue:t.robotOptions.host,"onUpdate:modelValue":o[1]||(o[1]=o=>t.robotOptions.host=o),label:"Host*"},null,8,["modelValue"]),(0,r.Wm)(c,{modelValue:t.robotOptions.restPort,"onUpdate:modelValue":o[2]||(o[2]=o=>t.robotOptions.restPort=o),type:"number",label:"REST Port*"},null,8,["modelValue"]),(0,r.Wm)(c,{modelValue:t.robotOptions.wsPort,"onUpdate:modelValue":o[3]||(o[3]=o=>t.robotOptions.wsPort=o),type:"number",label:"WS Port*"},null,8,["modelValue"]),(0,r.Wm)(c,{modelValue:t.robotOptions.token,"onUpdate:modelValue":o[4]||(o[4]=o=>t.robotOptions.token=o),label:"Token"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{align:"right"},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{color:"primary",onClick:t.connectRobot,disable:"success"!==t.checkStatus},{default:(0,r.w5)((()=>[l])),_:1},8,["onClick","disable"]),(0,r.Wm)(f,{color:"success"===t.checkStatus?"green":"error"===t.checkStatus?"red":"primary",type:"submit",loading:t.loading},{default:(0,r.w5)((()=>[d])),_:1},8,["color","loading"]),(0,r.Wm)(f,{color:"red",onClick:o[5]||(o[5]=o=>t.show=!t.show)},{default:(0,r.w5)((()=>[h])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,r.Wm)(f,{onClick:o[7]||(o[7]=o=>t.show=!t.show),round:"",color:"primary",icon:"add"})],64)}var p=e(1623),m=function(t,o,e,r){function n(t){return t instanceof e?t:new e((function(o){o(t)}))}return new(e||(e=Promise))((function(e,i){function s(t){try{a(r.next(t))}catch(o){i(o)}}function c(t){try{a(r["throw"](t))}catch(o){i(o)}}function a(t){t.done?e(t.value):n(t.value).then(s,c)}a((r=r.apply(t,o||[])).next())}))};const b=(0,r.aZ)({name:"ConnectRobotModal",setup(){return{store:(0,p.V)()}},data(){return{show:!1,loading:!1,checkStatus:null,robotOptions:{name:"",host:"localhost",token:"",restPort:4268,wsPort:4269}}},methods:{checkRobot(){return m(this,void 0,void 0,(function*(){this.loading=!0,(yield this.store.checkRobotAuth(this.robotOptions))?this.checkStatus="success":this.checkStatus="error",this.loading=!1}))},connectRobot(){this.store.addRobot(this.robotOptions),this.robotOptions={name:"",host:"localhost",token:"",restPort:4268,wsPort:4269},this.checkStatus=null,this.show=!1}}});var w=e(1639),g=e(7743),y=e(4458),v=e(8326),k=e(3190),_=e(6611),P=e(1821),S=e(4455),U=e(9984),W=e.n(U);const R=(0,w.Z)(b,[["render",f]]),V=R;W()(b,"components",{QDialog:g.Z,QCard:y.Z,QForm:v.Z,QCardSection:k.Z,QInput:_.Z,QCardActions:P.Z,QBtn:S.Z});var x=e(6970);const C={class:"row justify-between"},Z={class:"text-h6"},$=(0,r.Uk)("active"),q=(0,r.Uk)(" For logs "),Q=(0,r.Uk)(" More ");function O(t,o,e,n,i,s){const c=(0,r.up)("q-chip"),a=(0,r.up)("q-item-label"),u=(0,r.up)("q-card-section"),l=(0,r.up)("q-btn"),d=(0,r.up)("q-card-actions"),h=(0,r.up)("q-card");return(0,r.wg)(),(0,r.j4)(h,{style:{"max-width":"600px"},class:"q-mx-auto"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r._)("div",C,[(0,r._)("div",Z,(0,x.zw)(t.robot.name),1),(0,r.Wm)(c,{dense:"",dark:"",color:"blue"},{default:(0,r.w5)((()=>[$])),_:1})]),(0,r._)("div",null,[(0,r.Wm)(a,{caption:"",style:{"font-size":"16px","font-weight":"bold"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,x.zw)(t.portfolioStatistics.priceAll)+" $",1)])),_:1}),(0,r.Wm)(a,{caption:"",class:(0,x.C_)("text-"+(t.portfolioStatistics.growth?"green":"red")),style:{"font-size":"14px"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,x.zw)(t.portfolioStatistics.growth?"↑":"↓")+(0,x.zw)(t.portfolioStatistics.diffAbs)+" $ ("+(0,x.zw)(t.portfolioStatistics.diffPer)+" %) ",1)])),_:1},8,["class"])])])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[q])),_:1}),(0,r.Wm)(d,{align:"right"},{default:(0,r.w5)((()=>[(0,r.Wm)(l,{color:"blue",dark:"",to:`/robot/${t.robot.name}`},{default:(0,r.w5)((()=>[Q])),_:1},8,["to"])])),_:1})])),_:1})}var A=e(3260),H=e(7363),z=e(1354),M=e(410),j=function(t,o,e,r){function n(t){return t instanceof e?t:new e((function(o){o(t)}))}return new(e||(e=Promise))((function(e,i){function s(t){try{a(r.next(t))}catch(o){i(o)}}function c(t){try{a(r["throw"](t))}catch(o){i(o)}}function a(t){t.done?e(t.value):n(t.value).then(s,c)}a((r=r.apply(t,o||[])).next())}))};const E=(0,r.aZ)({name:"RobotTile",props:{robot:{type:A.n,required:!0}},data(){return{portfolio:[]}},computed:{portfolioStatistics(){return this.getPortfolioStatistics(this.portfolio)}},methods:Object.assign(Object.assign({},(0,H.nv)(M.I,["getPortfolioStatistics"])),(0,H.nv)(z.R,["getPortfolio","getSecurities"])),watch:{robot(t){return j(this,void 0,void 0,(function*(){this.portfolio=yield this.getPortfolio(t)}))}},created(){return j(this,void 0,void 0,(function*(){yield this.getSecurities(this.robot),this.portfolio=yield this.getPortfolio(this.robot)}))}});var T=e(7691),B=e(3115);const D=(0,w.Z)(E,[["render",O]]),I=D;W()(E,"components",{QCard:y.Z,QCardSection:k.Z,QChip:T.Z,QItemLabel:B.Z,QCardActions:P.Z,QBtn:S.Z});const L=(0,r.aZ)({name:"RobotsListScreen",setup(){const t=(0,p.V)();return{robotsStore:t}},components:{ConnectRobotModal:V,RobotTile:I}}),F=(0,w.Z)(L,[["render",a]]),Y=F;W()(L,"components",{QBtn:S.Z})}}]);