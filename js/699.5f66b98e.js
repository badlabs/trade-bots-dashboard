"use strict";(self["webpackChunktrade_bots_dashboard"]=self["webpackChunktrade_bots_dashboard"]||[]).push([[699],{3260:(t,e,o)=>{o.d(e,{n:()=>n});class n{constructor({name:t,host:e,restPort:o,wsPort:n,token:i}){this.name=t,this._host=e,this._restPort=o,this._wsPort=n,this._token=i}get restUrl(){return`http://${this._host}:${this._restPort}`}get wsUrl(){return`ws://${this._host}:${this._wsPort}`}get authHeader(){return{Authorization:`Bearer ${this._token}`}}}},410:(t,e,o)=>{o.d(e,{I:()=>l});var n=o(7363),i=o(7898),r=o(1623),s=o(1354),a=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function s(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):i(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())}))};const l=(0,n.Q_)("robotStatisticsActions",{state:()=>({}),getters:{},actions:{getPositionStatistics(t){const e=(0,i.$)(),o=e.getSecurity(t.security_ticker);if(!o)return;const n=t.amount*(t.buy_price||o.price),r=t.amount*o.price,s=Math.abs(n-r),a=s/n*100;return{buyPrice:n,price:r,growth:r>n,diffAbs:s,diffPer:a}},getPortfolioStatistics(t){return{buyPriceAll:0,priceAll:0,growth:!0,diffAbs:0,diffPer:0}},getUnitePortfolioStatistics(){return a(this,void 0,void 0,(function*(){(0,i.$)();const t=(0,r.V)(),e=(0,s.R)(),o=t.robots,n=o.map((t=>a(this,void 0,void 0,(function*(){return yield e.getPortfolio(t)})))),l=yield Promise.all(n),u=l.reduce(((t,e)=>(e.forEach((e=>{const o=t.find((t=>t.security_ticker==e.security_ticker));o?o.amount+=e.amount:t.push(e)})),t)),[]);return{unitedPortfolio:u,unitedPortfolioStatistics:this.getPortfolioStatistics(u)}}))}}})},1354:(t,e,o)=>{o.d(e,{R:()=>l});var n=o(7363),i=o(7898),r=o(9981),s=o.n(r),a=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function s(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):i(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())}))};const l=(0,n.Q_)("robotActions",{state:()=>({}),getters:{},actions:{getSecurities(t){return a(this,void 0,void 0,(function*(){const e=(0,i.$)(),{data:o}=yield s().get(`${t.restUrl}/api/state/securities`,{headers:t.authHeader});return e.updateSecurities(o),o}))},updateSecurities(t){return a(this,void 0,void 0,(function*(){const e=(0,i.$)(),{data:o}=yield s().post(`${t.restUrl}/api/state/securities`,{},{headers:t.authHeader});return e.updateSecurities(o),o}))},getPortfolio(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().get(`${t.restUrl}/api/state/portfolio`,{headers:t.authHeader});return e}))},updatePortfolio(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().post(`${t.restUrl}/api/state/portfolio`,{},{headers:t.authHeader});return e}))},getAlgorithms(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().get(`${t.restUrl}/api/algos`,{headers:t.authHeader});return e}))},getCurrencies(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().get(`${t.restUrl}/api/state/currencies`,{headers:t.authHeader});return e}))},updateCurrencies(t){return a(this,void 0,void 0,(function*(){const{data:e}=yield s().post(`${t.restUrl}/api/state/currencies`,{},{headers:t.authHeader});return e}))}}})},1623:(t,e,o)=>{o.d(e,{V:()=>u});var n=o(7363),i=o(3260),r=o(9981),s=o.n(r),a=o(1354),l=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function s(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):i(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())}))};const u=(0,n.Q_)("robots",{state:()=>({robots:[]}),getters:{},actions:{checkRobotAuth(t){return l(this,void 0,void 0,(function*(){try{const e=new i.n(t),{data:o}=yield s().get(`${e.restUrl}/api/auth/check`,{headers:e.authHeader});return o.auth}catch(e){return!1}}))},addRobot(t){return l(this,void 0,void 0,(function*(){const e=(0,a.R)();if(!this.checkExistingRobot(t)){const o=new i.n(t);yield e.updateSecurities(o),yield e.updatePortfolio(o),this.robots.push(o)}}))},checkExistingRobot(t){const e=new i.n(t);return this.robots.some((t=>t.restUrl===e.restUrl||t.wsUrl===e.wsUrl))}}})},7898:(t,e,o)=>{o.d(e,{$:()=>i});var n=o(7363);const i=(0,n.Q_)("securities",{state:()=>({securities:[]}),getters:{},actions:{updateSecurities(t){t.forEach((t=>{const e=this.securities.find((e=>e.ticker===t.ticker));e?e.price=t.price:this.securities.push(t)}))},getSecurity(t){return this.securities.find((e=>e.ticker===t))}}})},5588:(t,e,o)=>{o.d(e,{Z:()=>_});var n=o(9835),i=o(6970);const r={class:"q-px-md q-my-lg q-mx-auto",style:{"max-width":"800px",background:"lightgray","border-radius":"5px"}},s={class:"q-pa-md"},a={class:"q-pt-md",style:{"font-size":"16px","font-weight":"bold"}},l={class:"q-pa-md"};function u(t,e,o,u,c,d){const p=(0,n.up)("q-item-label"),h=(0,n.up)("q-item-section"),m=(0,n.up)("q-item"),f=(0,n.up)("q-list");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",s,[(0,n._)("div",a," Total Currencies: $"+(0,i.zw)(t.statistics.priceAll),1),(0,n._)("div",{style:{"font-size":"14px"},class:(0,i.C_)("text-"+(t.statistics.growth?"green":"red"))},(0,i.zw)(t.statistics.growth?"↑":"↓")+(0,i.zw)(t.statistics.diffAbs)+" $ ("+(0,i.zw)(t.statistics.diffPer)+" %) ",3)]),(0,n._)("div",l,[(0,n.Wm)(f,{separator:"",style:{"max-height":"300px","overflow-y":"auto"},class:"bg-white"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.portfolio,((e,o)=>((0,n.wg)(),(0,n.j4)(m,{key:o},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Wm)(p,{style:{"font-size":"18px","font-weight":"bold"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(e.security_ticker),1)])),_:2},1024),(0,n.Wm)(p,{caption:"",style:{"font-size":"14px"}},{default:(0,n.w5)((()=>[(0,n.Uk)("x"+(0,i.zw)(e.amount),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(h,{side:"",top:""},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{caption:"",style:{"font-size":"16px","font-weight":"bold"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.getPositionStatistics(e).price)+" $ ",1)])),_:2},1024),(0,n.Wm)(p,{caption:"",class:(0,i.C_)("text-"+(t.getPositionStatistics(e).growth?"green":"red")),style:{"font-size":"14px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.getPositionStatistics(e).growth?"↑":"↓")+(0,i.zw)(t.getPositionStatistics(e).diffAbs)+" $ ("+(0,i.zw)(t.getPositionStatistics(e).diffPer)+" %) ",1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])}var c=o(410),d=o(7363);const p=(0,n.aZ)({name:"PortfolioStatistics",props:{portfolio:{type:Array,required:!0}},computed:{statistics(){return this.getPortfolioStatistics(this.portfolio)}},methods:Object.assign({},(0,d.nv)(c.I,["getPortfolioStatistics","getPositionStatistics"]))});var h=o(1639),m=o(3246),f=o(490),w=o(1233),g=o(3115),b=o(9984),y=o.n(b);const v=(0,h.Z)(p,[["render",u]]),_=v;y()(p,"components",{QList:m.Z,QItem:f.Z,QItemSection:w.Z,QItemLabel:g.Z})},1699:(t,e,o)=>{o.r(e),o.d(e,{default:()=>it});var n=o(9835),i=o(6970);const r={class:"q-pa-md"},s={class:"q-gutter-sm"},a={class:"row justify-between"};function l(t,e,o,l,u,c){const d=(0,n.up)("q-btn"),p=(0,n.up)("RobotLogsModal"),h=(0,n.up)("PortfolioStatistics"),m=(0,n.up)("AlgosList");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",s,[(0,n.Wm)(d,{color:"primary",to:"/robots",label:"< Robots"})]),(0,n._)("div",a,[(0,n._)("h4",null,"Robot "+(0,i.zw)(t.robot.name),1),(0,n._)("div",null,[(0,n.Wm)(p,{robot:t.robot},null,8,["robot"])])]),(0,n.Wm)(h,{portfolio:t.portfolio},null,8,["portfolio"]),(0,n.Wm)(m,{algorithms:t.algorithms,robot:t.robot},null,8,["algorithms","robot"])])}var u=o(1623),c=o(1354),d=o(7363),p=o(3260),h=o(5588);const m={class:"bg-black text-white q-pa-md",style:{"max-width":"600px","max-height":"400px",overflow:"auto"}},f=(0,n.Uk)("Close"),w=(0,n.Uk)("Logs");function g(t,e,o,r,s,a){const l=(0,n.up)("q-card-section"),u=(0,n.up)("q-btn"),c=(0,n.up)("q-card-actions"),d=(0,n.up)("q-card"),p=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(p,{modelValue:t.show,"onUpdate:modelValue":e[1]||(e[1]=e=>t.show=e),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{style:{"min-width":"400px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Logs "+(0,i.zw)(t.robot.name),1)])),_:1}),(0,n._)("code",null,[(0,n._)("pre",m,(0,i.zw)(t.logs),1)]),(0,n.Wm)(c,{align:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{color:"red",onClick:e[0]||(e[0]=e=>t.show=!t.show)},{default:(0,n.w5)((()=>[f])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(u,{onClick:e[2]||(e[2]=e=>t.show=!t.show),color:"primary"},{default:(0,n.w5)((()=>[w])),_:1})],64)}const b=(0,n.aZ)({name:"RobotLogsModal",props:{robot:{type:p.n,required:!0}},data(){return{show:!1,connection:null,logs:""}},created(){const t=`${this.robot.wsUrl}`;this.connection=new WebSocket(t),this.connection.onmessage=t=>{console.log(t),this.logs+=t.data+"\n"},this.connection.onopen=function(t){console.log(t),console.log("Successfully connected to the echo websocket server...")}},beforeDestroy(){var t;null===(t=this.connection)||void 0===t||t.close()}});var y=o(1639),v=o(7743),_=o(4458),k=o(3190),q=o(1821),x=o(4455),V=o(9984),P=o.n(V);const Z=(0,y.Z)(b,[["render",g]]),W=Z;P()(b,"components",{QDialog:v.Z,QCard:_.Z,QCardSection:k.Z,QCardActions:q.Z,QBtn:x.Z});const U=(0,n.Uk)(" Algorithms ");function S(t,e,o,r,s,a){const l=(0,n.up)("q-card-section"),u=(0,n.up)("q-item-section"),c=(0,n.up)("q-chip"),d=(0,n.up)("q-item-label"),p=(0,n.up)("q-item"),h=(0,n.up)("q-list"),m=(0,n.up)("RunAlgoModal"),f=(0,n.up)("q-card-actions"),w=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(w,{class:"q-pa-md q-my-lg q-mx-auto",style:{"max-width":"800px",background:"lightblue","border-radius":"5px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{class:"text-h3"},{default:(0,n.w5)((()=>[U])),_:1}),(0,n.Wm)(h,{style:{"max-height":"300px","overflow-y":"auto"},separator:""},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.algorithms,((e,o)=>((0,n.wg)(),(0,n.j4)(p,{key:o,dense:""},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{class:"q-pa-sm q-my-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{class:"my-card",style:{"max-height":"300px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{class:"text-h5"},{default:(0,n.w5)((()=>[(0,n.Uk)("Algorithm "+(0,i.zw)(e.name),1)])),_:2},1024),(0,n.Wm)(h,{separator:"",class:"bg-white"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.inputs,(t=>((0,n.wg)(),(0,n.j4)(p,{key:t.name},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(t.name),1)])),_:2},1024),(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n._)("code",null,(0,i.zw)(t.type),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024),(0,n.Wm)(f,{align:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{robot:t.robot,algorithm:e},null,8,["robot","algorithm"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})}var Q=o(1957);const A=(0,n.Uk)(" Start "),$=(0,n.Uk)("Cancel"),C=(0,n.Uk)("Run");function z(t,e,o,i,r,s){const a=(0,n.up)("q-input"),l=(0,n.up)("OrderOptionsInput"),u=(0,n.up)("q-card-section"),c=(0,n.up)("q-btn"),d=(0,n.up)("q-card-actions"),p=(0,n.up)("q-form"),h=(0,n.up)("q-card"),m=(0,n.up)("q-dialog");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(m,{modelValue:t.show,"onUpdate:modelValue":e[1]||(e[1]=e=>t.show=e),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{style:{"min-width":"400px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{onSubmit:(0,Q.iM)(t.startAlgo,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.fields,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t.name},["number"===t.type?((0,n.wg)(),(0,n.j4)(a,{key:0,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,type:"number",label:t.name},null,8,["modelValue","onUpdate:modelValue","label"])):"OrderDetails"===t.type?((0,n.wg)(),(0,n.j4)(l,{key:1,modelValue:t.value,"onUpdate:modelValue":e=>t.value=e,label:t.name},null,8,["modelValue","onUpdate:modelValue","label"])):(0,n.kq)("",!0)])))),128))])),_:1}),(0,n.Wm)(d,{align:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{color:"primary",type:"submit",loading:t.loading},{default:(0,n.w5)((()=>[A])),_:1},8,["loading"]),(0,n.Wm)(c,{color:"red",onClick:e[0]||(e[0]=e=>t.show=!t.show)},{default:(0,n.w5)((()=>[$])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(c,{onClick:e[2]||(e[2]=e=>t.show=!t.show),color:"primary"},{default:(0,n.w5)((()=>[C])),_:1})],64)}function I(t,e,o,r,s,a){const l=(0,n.up)("q-input"),u=(0,n.up)("q-select"),c=(0,n.up)("q-card-section"),d=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c,{class:"row justify-between"},{default:(0,n.w5)((()=>[(0,n._)("div",null,(0,i.zw)(t.label||"OrderDetails"),1),(0,n._)("div",null,[(0,n.Wm)(l,{modelValue:t.currentValue.ticker,"onUpdate:modelValue":e[0]||(e[0]=e=>t.currentValue.ticker=e),label:"Ticker",onInput:t.input},null,8,["modelValue","onInput"]),(0,n.Wm)(u,{modelValue:t.currentValue.operation,"onUpdate:modelValue":e[1]||(e[1]=e=>t.currentValue.operation=e),options:t.operationTypes,label:"Operation",onInput:t.input},null,8,["modelValue","options","onInput"]),(0,n.Wm)(l,{modelValue:t.currentValue.price,"onUpdate:modelValue":e[2]||(e[2]=e=>t.currentValue.price=e),type:"number",label:"Price",onInput:t.input},null,8,["modelValue","onInput"]),(0,n.Wm)(l,{modelValue:t.currentValue.lots,"onUpdate:modelValue":e[3]||(e[3]=e=>t.currentValue.lots=e),type:"number",label:"Lots",onInput:t.input},null,8,["modelValue","onInput"])])])),_:1})])),_:1})}const R=(0,n.aZ)({name:"OrderOptionsInput",props:{label:String,modelValue:{type:Object,required:!0}},data(){return{currentValue:this.modelValue,operationTypes:["buy","sell","buy_or_cancel","sell_or_cancel"]}},methods:{input(){this.$emit("update:modelValue",this.currentValue)},onValueChange(t){this.currentValue=t,this.input()}},watch:{value(t){this.onValueChange(t)}}});var D=o(6611),O=o(8542);const j=(0,y.Z)(R,[["render",I]]),H=j;P()(R,"components",{QCard:_.Z,QCardSection:k.Z,QInput:D.Z,QSelect:O.Z});var L=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function s(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):i(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())}))};const M=(0,n.aZ)({name:"RunAlgoModal",props:{algorithm:{type:Object,required:!0},robot:{type:p.n,required:!0}},components:{OrderOptionsInput:H},data(){return{show:!1,loading:!1,fields:[]}},methods:{startAlgo(){return L(this,void 0,void 0,(function*(){this.loading=!0;const t={};this.fields.forEach((e=>{t[e.name]=e.value})),yield this.$axios.post(`${this.robot.restUrl}/api/algos/${this.algorithm.name}`,t,{headers:this.robot.authHeader}),this.loading=!1,this.show=!1}))}},created(){this.fields=this.algorithm.inputs.map((t=>{let e=0;switch(t.type){case"number":e=0;break;case"OrderDetails":e={lots:0,operation:"buy",price:0,ticker:""}}return{name:t.name,type:t.type,value:e}}))}});var Y=o(8326);const E=(0,y.Z)(M,[["render",z]]),B=E;P()(M,"components",{QDialog:v.Z,QCard:_.Z,QForm:Y.Z,QCardSection:k.Z,QInput:D.Z,QCardActions:q.Z,QBtn:x.Z});const K=(0,n.aZ)({name:"AlgosList",props:{algorithms:{type:Array,required:!0},robot:{type:p.n,required:!0}},components:{RunAlgoModal:B}});var T=o(3246),F=o(490),G=o(1233),J=o(3115),N=o(7691);const X=(0,y.Z)(K,[["render",S]]),tt=X;P()(K,"components",{QCard:_.Z,QCardSection:k.Z,QList:T.Z,QItem:F.Z,QItemSection:G.Z,QItemLabel:J.Z,QChip:N.Z,QCardActions:q.Z});var et=function(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function s(t){try{l(n.next(t))}catch(e){r(e)}}function a(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):i(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())}))};const ot=(0,n.aZ)({name:"RobotScreen",components:{PortfolioStatistics:h.Z,AlgosList:tt,RobotLogsModal:W},data(){return{portfolio:[],algorithms:[]}},computed:Object.assign(Object.assign({},(0,d.rn)(u.V,["robots"])),{robot(){const t=this.robots.find((t=>t.name===this.$route.params.robot));return t||(this.$router.push("/"),new p.n({name:"",host:"",restPort:0,wsPort:0,token:""}))}}),methods:Object.assign(Object.assign({},(0,d.nv)(c.R,["getPortfolio","getAlgorithms"])),{updateRobotData(){return et(this,void 0,void 0,(function*(){this.portfolio=yield this.getPortfolio(this.robot),this.algorithms=yield this.getAlgorithms(this.robot)}))}}),watch:{robot(){this.updateRobotData()}},created(){this.updateRobotData()}}),nt=(0,y.Z)(ot,[["render",l]]),it=nt;P()(ot,"components",{QBtn:x.Z})}}]);